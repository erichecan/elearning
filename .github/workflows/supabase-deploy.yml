name: Deploy Supabase DB

on:
  push:
    paths:
      - 'supabase/migrations/**'
      - '.github/workflows/supabase-deploy.yml'
    branches:
      - main
      - master

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        
      - name: Simple Migration Check
        run: |
          echo "ğŸš€ GitHub Actions é…ç½®éªŒè¯æˆåŠŸï¼"
          echo "ğŸ“‹ æ£€æµ‹åˆ°çš„è¿ç§»æ–‡ä»¶ï¼š"
          
          for migration_file in supabase/migrations/*.sql; do
            if [ -f "$migration_file" ]; then
              echo "  âœ… $(basename "$migration_file")"
            fi
          done
          
          echo ""
          echo "ğŸ’¡ è¦æ‰‹åŠ¨åŒæ­¥æ•°æ®åº“ï¼Œè¯·åœ¨æœ¬åœ°è¿è¡Œï¼š"
          echo "   npm run db:deploy"
          echo ""
          echo "ğŸ‰ GitHub Actions è¿è¡ŒæˆåŠŸï¼"
          echo "ï¿½ï¿½ æ•°æ®åº“åŒæ­¥è¯·ä½¿ç”¨æœ¬åœ°è„šæœ¬å®Œæˆã€‚" 